<!DOCTYPE html><HTML lang="en"><head><script charset="utf-8" src="../../../assets/default/multidoc_injector.js" type="text/javascript"></script><script charset="utf-8" type="text/javascript">window.MULTIDOCUMENTER_ROOT_PATH = '/'</script><script charset="utf-8" src="../../../assets/default/flexsearch.bundle.js" type="text/javascript"></script><script charset="utf-8" src="../../../assets/default/flexsearch_integration.js" type="text/javascript"></script><meta charset="UTF-8"/><meta content="width=device-width, initial-scale=1.0" name="viewport"/><title>Lib · QuantumCollocationCore.jl</title><meta content="Lib · QuantumCollocationCore.jl" name="title"/><meta content="Lib · QuantumCollocationCore.jl" property="og:title"/><meta content="Lib · QuantumCollocationCore.jl" property="twitter:title"/><meta content="Documentation for QuantumCollocationCore.jl." name="description"/><meta content="Documentation for QuantumCollocationCore.jl." property="og:description"/><meta content="Documentation for QuantumCollocationCore.jl." property="twitter:description"/><meta content="https://docs.harmoniqs.co/QuantumCollocationCore.jl/lib/" property="og:url"/><meta content="https://docs.harmoniqs.co/QuantumCollocationCore.jl/lib/" property="twitter:url"/><link href="https://docs.harmoniqs.co/QuantumCollocationCore/dev/lib/" rel="canonical"/><script data-outdated-warner="" src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script data-main="../assets/documenter.js" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" data-theme-name="catppuccin-mocha" href="../assets/themes/catppuccin-mocha.css" rel="stylesheet" type="text/css"/><link class="docs-theme-link" data-theme-name="catppuccin-macchiato" href="../assets/themes/catppuccin-macchiato.css" rel="stylesheet" type="text/css"/><link class="docs-theme-link" data-theme-name="catppuccin-frappe" href="../assets/themes/catppuccin-frappe.css" rel="stylesheet" type="text/css"/><link class="docs-theme-link" data-theme-name="catppuccin-latte" href="../assets/themes/catppuccin-latte.css" rel="stylesheet" type="text/css"/><link class="docs-theme-link" data-theme-name="documenter-dark" data-theme-primary-dark="" href="../assets/themes/documenter-dark.css" rel="stylesheet" type="text/css"/><link class="docs-theme-link" data-theme-name="documenter-light" data-theme-primary="" href="../assets/themes/documenter-light.css" rel="stylesheet" type="text/css"/><script src="../assets/themeswap.js"></script><link href="../../../assets/default/multidoc.css" rel="stylesheet" type="text/css"/><link href="../../../assets/default/flexsearch.css" rel="stylesheet" type="text/css"/></head><body><nav id="multi-page-nav"><div class="hidden-on-mobile" id="nav-items"><a class="nav-link nav-item" href="../../../Piccolo/">Piccolo</a><a class="nav-link nav-item" href="../../../PiccoloQuantumObjects/">Quantum Objects</a><div class="nav-dropdown"><button class="nav-item dropdown-label">Optimal Controls</button><ul class="nav-dropdown-container"><a class="nav-link nav-item" href="../../../QuantumCollocation/">QuantumCollocation.jl</a><a class="nav-link active nav-item" href="../../">QuantumCollocationCore.jl</a></ul></div><div class="nav-dropdown"><button class="nav-item dropdown-label">Trajectories</button><ul class="nav-dropdown-container"><a class="nav-link nav-item" href="../../../NamedTrajectories/">NamedTrajectories.jl</a><a class="nav-link nav-item" href="../../../TrajectoryIndexingUtils/">TrajectoryIndexingUtils.jl</a></ul></div><a class="nav-link nav-item" href="../../../PiccoloPlots/">Plots</a><div class="search nav-item"><input id="search-input" placeholder="Search everywhere..."/><ul class="suggestions hidden" id="search-result-container"></ul><div class="search-keybinding">/</div></div></div><button id="multidoc-toggler"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg></button></nav><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img alt="QuantumCollocationCore.jl logo" src="../assets/logo.svg"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">QuantumCollocationCore.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href="">Lib</a><ul class="internal"><li><a class="tocitem" href="#Constraints"><span>Constraints</span></a></li><li><a class="tocitem" href="#Integrators"><span>Integrators</span></a></li><li><a class="tocitem" href="#Losses"><span>Losses</span></a></li><li><a class="tocitem" href="#Objectives"><span>Objectives</span></a></li><li><a class="tocitem" href="#Dynamics"><span>Dynamics</span></a></li><li><a class="tocitem" href="#Options"><span>Options</span></a></li><li><a class="tocitem" href="#Problem-Solvers"><span>Problem Solvers</span></a></li><li><a class="tocitem" href="#Problems"><span>Problems</span></a></li><li><a class="tocitem" href="#Saving-and-Loading"><span>Saving and Loading</span></a></li></ul></li><li><a class="tocitem" href="../generated/explanation/">Explanation</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" href="#" id="documenter-sidebar-button"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="">Lib</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="">Lib</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/harmoniqs/QuantumCollocationCore.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/harmoniqs/QuantumCollocationCore.jl/blob/main/docs/src/lib.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" href="#" id="documenter-settings-button" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" href="javascript:;" id="documenter-article-toggle-button" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Library"><a class="docs-heading-anchor" href="#Library">Library</a><a id="Library-1"></a><a class="docs-heading-anchor-permalink" href="#Library" title="Permalink"></a></h1><h2 id="Constraints"><a class="docs-heading-anchor" href="#Constraints">Constraints</a><a id="Constraints-1"></a><a class="docs-heading-anchor-permalink" href="#Constraints" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#QuantumCollocationCore.Constraints.EqualityConstraint" id="QuantumCollocationCore.Constraints.EqualityConstraint"><code>QuantumCollocationCore.Constraints.EqualityConstraint</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct EqualityConstraint</code></pre><p>Represents a linear equality constraint.</p><p><strong>Fields</strong></p><ul><li><code>ts::AbstractArray{Int}</code>: the time steps at which the constraint is applied</li><li><code>js::AbstractArray{Int}</code>: the components of the trajectory at which the constraint is applied</li><li><code>vals::Vector{R}</code>: the values of the constraint</li><li><code>vardim::Int</code>: the dimension of a single time step of the trajectory</li><li><code>label::String</code>: a label for the constraint</li></ul></div><a class="docs-sourcelink" href="https://github.com/harmoniqs/QuantumCollocationCore.jl/blob/624a5f4c1c514a95ec303e1b377c923488705b30/src/constraints/linear_trajectory_constraints.jl#L80-L92" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#QuantumCollocationCore.Constraints.NonlinearEqualityConstraint" id="QuantumCollocationCore.Constraints.NonlinearEqualityConstraint"><code>QuantumCollocationCore.Constraints.NonlinearEqualityConstraint</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct NonlinearEqualityConstraint</code></pre><p>Represents a nonlinear equality constraint.</p><p><strong>Fields</strong></p><ul><li><code>g::Function</code>: the constraint function</li><li><code>∂g::Function</code>: the Jacobian of the constraint function</li><li><code>∂g_structure::Vector{Tuple{Int, Int}}</code>: the structure of the Jacobian  i.e. all non-zero entries</li><li><code>μ∂²g::Function</code>: the Hessian of the constraint function</li><li><code>μ∂²g_structure::Vector{Tuple{Int, Int}}</code>: the structure of the Hessian</li><li><code>dim::Int</code>: the dimension of the constraint function</li><li><code>params::Dict{Symbol, Any}</code>: a dictionary of parameters</li></ul></div><a class="docs-sourcelink" href="https://github.com/harmoniqs/QuantumCollocationCore.jl/blob/624a5f4c1c514a95ec303e1b377c923488705b30/src/constraints/_constraints.jl#L77-L92" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#QuantumCollocationCore.Constraints.NonlinearInequalityConstraint" id="QuantumCollocationCore.Constraints.NonlinearInequalityConstraint"><code>QuantumCollocationCore.Constraints.NonlinearInequalityConstraint</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct NonlinearInequalityConstraint</code></pre><p>Represents a nonlinear inequality constraint.</p><p><strong>Fields</strong></p><ul><li><code>g::Function</code>: the constraint function</li><li><code>∂g::Function</code>: the Jacobian of the constraint function</li><li><code>∂g_structure::Vector{Tuple{Int, Int}}</code>: the structure of the Jacobian  i.e. all non-zero entries</li><li><code>μ∂²g::Function</code>: the Hessian of the constraint function</li><li><code>μ∂²g_structure::Vector{Tuple{Int, Int}}</code>: the structure of the Hessian</li><li><code>dim::Int</code>: the dimension of the constraint function</li><li><code>params::Dict{Symbol, Any}</code>: a dictionary of parameters containing additional  information about the constraint</li></ul></div><a class="docs-sourcelink" href="https://github.com/harmoniqs/QuantumCollocationCore.jl/blob/624a5f4c1c514a95ec303e1b377c923488705b30/src/constraints/_constraints.jl#L103-L119" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#QuantumCollocationCore.Constraints.ComplexModulusContraint-Tuple{Symbol, Float64, NamedTrajectories.StructNamedTrajectory.NamedTrajectory}" id="QuantumCollocationCore.Constraints.ComplexModulusContraint-Tuple{Symbol, Float64, NamedTrajectories.StructNamedTrajectory.NamedTrajectory}"><code>QuantumCollocationCore.Constraints.ComplexModulusContraint</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ComplexModulusContraint(symb::Symbol, R::Float64, traj::NamedTrajectory)</code></pre><p>Returns a ComplexModulusContraint for the complex control NamedTrajector symbol where R is the maximum allowed complex modulus.</p></div><a class="docs-sourcelink" href="https://github.com/harmoniqs/QuantumCollocationCore.jl/blob/624a5f4c1c514a95ec303e1b377c923488705b30/src/constraints/complex_modulus_constraint.jl#L124-L129" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#QuantumCollocationCore.Constraints.ComplexModulusContraint-Tuple{}" id="QuantumCollocationCore.Constraints.ComplexModulusContraint-Tuple{}"><code>QuantumCollocationCore.Constraints.ComplexModulusContraint</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ComplexModulusContraint(&lt;keyword arguments&gt;)</code></pre><p>Returns a NonlinearInequalityConstraint on the complex modulus of a complex control</p><p>TODO: Changed zdim -&gt; dim. Constraint should be tested for global params.</p><p><strong>Arguments</strong></p><ul><li><code>R::Union{Float64,Nothing}=nothing</code>: the maximum allowed complex modulus</li><li><code>comps::Union{AbstractVector{Int},Nothing}=nothing</code>: the components of the complex control,  both the real and imaginary parts</li><li><code>times::Union{AbstractVector{Int},Nothing}=nothing</code>: the times at which the constraint is applied</li><li><code>dim::Union{Int,Nothing}=nothing</code>: the dimension of a single time step of the trajectory</li><li><code>T::Union{Int,Nothing}=nothing</code>: the number of time steps</li></ul></div><a class="docs-sourcelink" href="https://github.com/harmoniqs/QuantumCollocationCore.jl/blob/624a5f4c1c514a95ec303e1b377c923488705b30/src/constraints/complex_modulus_constraint.jl#L4-L18" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#QuantumCollocationCore.Constraints.FinalFidelityConstraint-Tuple{}" id="QuantumCollocationCore.Constraints.FinalFidelityConstraint-Tuple{}"><code>QuantumCollocationCore.Constraints.FinalFidelityConstraint</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">FinalFidelityConstraint(&lt;keyword arguments&gt;)</code></pre><p>Returns a NonlinearInequalityConstraint representing a constraint on the minimum allowed fidelity.</p><p><strong>Arguments</strong></p><ul><li><code>fidelity_function::Union{Function,Nothing}=nothing</code>: the fidelity function</li><li><code>value::Union{Float64,Nothing}=nothing</code>: the minimum fidelity value allowed  by the constraint</li><li><code>comps::Union{AbstractVector{Int},Nothing}=nothing</code>: the components of the  state to which the fidelity function is applied</li><li><code>goal::Union{AbstractVector{Float64},Nothing}=nothing</code>: the goal state</li><li><code>statedim::Union{Int,Nothing}=nothing</code>: the dimension of the state</li><li><code>zdim::Union{Int,Nothing}=nothing</code>: the dimension of a single time step of the trajectory</li><li><code>T::Union{Int,Nothing}=nothing</code>: the number of time steps</li><li><code>subspace::Union{AbstractVector{&lt;:Integer}, Nothing}=nothing</code>: the subspace indices of the fidelity</li></ul></div><a class="docs-sourcelink" href="https://github.com/harmoniqs/QuantumCollocationCore.jl/blob/624a5f4c1c514a95ec303e1b377c923488705b30/src/constraints/fidelity_constraint.jl#L10-L29" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#QuantumCollocationCore.Constraints.FinalQuantumStateFidelityConstraint-Tuple{Symbol, Float64, NamedTrajectories.StructNamedTrajectory.NamedTrajectory}" id="QuantumCollocationCore.Constraints.FinalQuantumStateFidelityConstraint-Tuple{Symbol, Float64, NamedTrajectories.StructNamedTrajectory.NamedTrajectory}"><code>QuantumCollocationCore.Constraints.FinalQuantumStateFidelityConstraint</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">FinalQuantumStateFidelityConstraint(statesymb::Symbol, val::Float64, traj::NamedTrajectory)</code></pre><p>Returns a FinalFidelityConstraint for the unitary fidelity function where statesymb is the NamedTrajectory symbol representing the unitary.</p></div><a class="docs-sourcelink" href="https://github.com/harmoniqs/QuantumCollocationCore.jl/blob/624a5f4c1c514a95ec303e1b377c923488705b30/src/constraints/fidelity_constraint.jl#L181-L187" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#QuantumCollocationCore.Constraints.FinalUnitaryFidelityConstraint-Tuple{Symbol, Float64, NamedTrajectories.StructNamedTrajectory.NamedTrajectory}" id="QuantumCollocationCore.Constraints.FinalUnitaryFidelityConstraint-Tuple{Symbol, Float64, NamedTrajectories.StructNamedTrajectory.NamedTrajectory}"><code>QuantumCollocationCore.Constraints.FinalUnitaryFidelityConstraint</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">FinalUnitaryFidelityConstraint(statesymb::Symbol, val::Float64, traj::NamedTrajectory)</code></pre><p>Returns a FinalFidelityConstraint for the unitary fidelity function where statesymb is the NamedTrajectory symbol representing the unitary.</p></div><a class="docs-sourcelink" href="https://github.com/harmoniqs/QuantumCollocationCore.jl/blob/624a5f4c1c514a95ec303e1b377c923488705b30/src/constraints/fidelity_constraint.jl#L150-L156" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#QuantumCollocationCore.Constraints.FinalUnitaryFreePhaseFidelityConstraint-Tuple{}" id="QuantumCollocationCore.Constraints.FinalUnitaryFreePhaseFidelityConstraint-Tuple{}"><code>QuantumCollocationCore.Constraints.FinalUnitaryFreePhaseFidelityConstraint</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">FinalUnitaryFreePhaseFidelityConstraint</code></pre><p>Returns a NonlinearInequalityConstraint representing a constraint on the minimum allowed fidelity for a free phase unitary.</p></div><a class="docs-sourcelink" href="https://github.com/harmoniqs/QuantumCollocationCore.jl/blob/624a5f4c1c514a95ec303e1b377c923488705b30/src/constraints/fidelity_constraint.jl#L211-L217" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#QuantumCollocationCore.Constraints.constrain!-Tuple{Ipopt.Optimizer, Vector{MathOptInterface.VariableIndex}, Vector{LinearConstraint}, NamedTrajectories.StructNamedTrajectory.NamedTrajectory}" id="QuantumCollocationCore.Constraints.constrain!-Tuple{Ipopt.Optimizer, Vector{MathOptInterface.VariableIndex}, Vector{LinearConstraint}, NamedTrajectories.StructNamedTrajectory.NamedTrajectory}"><code>QuantumCollocationCore.Constraints.constrain!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">constrain!(opt::Ipopt.Optimizer, vars::Vector{MOI.VariableIndex}, cons::Vector{LinearConstraint}, traj::NamedTrajectory; verbose=false)</code></pre><p>Supplies a set of LinearConstraints to  IPOPT using MathOptInterface</p></div><a class="docs-sourcelink" href="https://github.com/harmoniqs/QuantumCollocationCore.jl/blob/624a5f4c1c514a95ec303e1b377c923488705b30/src/constraints/_constraints.jl#L46-L51" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#QuantumCollocationCore.Constraints.trajectory_constraints-Tuple{NamedTrajectories.StructNamedTrajectory.NamedTrajectory}" id="QuantumCollocationCore.Constraints.trajectory_constraints-Tuple{NamedTrajectories.StructNamedTrajectory.NamedTrajectory}"><code>QuantumCollocationCore.Constraints.trajectory_constraints</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">trajectory_constraints(traj::NamedTrajectory)</code></pre><p>Implements the initial and final value constraints and bounds constraints on the controls and states as specified by traj.</p></div><a class="docs-sourcelink" href="https://github.com/harmoniqs/QuantumCollocationCore.jl/blob/624a5f4c1c514a95ec303e1b377c923488705b30/src/constraints/linear_trajectory_constraints.jl#L9-L15" target="_blank">source</a></section></article><h2 id="Integrators"><a class="docs-heading-anchor" href="#Integrators">Integrators</a><a id="Integrators-1"></a><a class="docs-heading-anchor-permalink" href="#Integrators" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#QuantumCollocationCore.Integrators.UnitaryPadeIntegrator" id="QuantumCollocationCore.Integrators.UnitaryPadeIntegrator"><code>QuantumCollocationCore.Integrators.UnitaryPadeIntegrator</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div></div><a class="docs-sourcelink" href="https://github.com/harmoniqs/QuantumCollocationCore.jl/blob/624a5f4c1c514a95ec303e1b377c923488705b30/src/integrators/pade_integrators.jl#L189" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#QuantumCollocationCore.Integrators.UnitaryPadeIntegrator-Tuple{Symbol, Union{Symbol, Tuple{Vararg{Symbol}}}, PiccoloQuantumObjects.QuantumSystems.QuantumSystem, NamedTrajectories.StructNamedTrajectory.NamedTrajectory}" id="QuantumCollocationCore.Integrators.UnitaryPadeIntegrator-Tuple{Symbol, Union{Symbol, Tuple{Vararg{Symbol}}}, PiccoloQuantumObjects.QuantumSystems.QuantumSystem, NamedTrajectories.StructNamedTrajectory.NamedTrajectory}"><code>QuantumCollocationCore.Integrators.UnitaryPadeIntegrator</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">UnitaryPadeIntegrator(
    unitary_name::Symbol,
    drive_name::Union{Symbol,Tuple{Vararg{Symbol}}},
    G::Function,
    ∂G::Function,
    traj::NamedTrajectory;
    order::Int=4,
    calculate_pade_operators_structure::Bool=true,
    autodiff::Bool=false
)</code></pre><p>Construct a <code>UnitaryPadeIntegrator</code> which computes</p><p class="math-container">\[\text{isovec}\qty(B^{(n)}(a_t) U_{t+1} - F^{(n)}(a_t) U_t)\]</p><p>where <code>U_t</code> is the unitary at time <code>t</code>, <code>a_t</code> is the control at time <code>t</code>, and <code>B^{(n)}(a_t)</code> and <code>F^{(n)}(a_t)</code> are the <code>n</code>th order Pade operators of the exponential of the drift operator <code>G(a_t)</code>.</p><p><strong>Arguments</strong></p><ul><li><code>unitary_name::Symbol</code>: the name of the unitary in the trajectory</li><li><code>drive_name::Union{Symbol,Tuple{Vararg{Symbol}}}</code>: the name of the drive(s) in the trajectory</li><li><code>G::Function</code>: a function which takes the control vector <code>a_t</code> and returns the drive <code>G(a_t)</code>, <span>$G(a_t) = \text{iso}(-i H(a_t))$</span></li><li><code>∂G::Function</code>: a function which takes the control vector <code>a_t</code> and returns a vector of matrices <span>$\qty(\ldots, \pdv{G}{a^j_t}, \ldots)$</span></li><li><code>traj::NamedTrajectory</code>: the trajectory</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>order::Int=4</code>: the order of the Pade approximation. Must be in <code>[4, 6, 8, 10, 12, 14, 16, 18, 20]</code>.</li></ul></div><a class="docs-sourcelink" href="https://github.com/harmoniqs/QuantumCollocationCore.jl/blob/624a5f4c1c514a95ec303e1b377c923488705b30/src/integrators/pade_integrators.jl#L205-L235" target="_blank">source</a></section></article><h2 id="Losses"><a class="docs-heading-anchor" href="#Losses">Losses</a><a id="Losses-1"></a><a class="docs-heading-anchor-permalink" href="#Losses" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#QuantumCollocationCore.Losses.iso_fidelity-Tuple{AbstractVector{&lt;:Real}, AbstractVector{&lt;:Real}}" id="QuantumCollocationCore.Losses.iso_fidelity-Tuple{AbstractVector{&lt;:Real}, AbstractVector{&lt;:Real}}"><code>QuantumCollocationCore.Losses.iso_fidelity</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">iso_fidelity(ψ̃, ψ̃_goal)</code></pre><p>Calculate the fidelity between two quantum states <code>ψ</code> and <code>ψ_goal</code>.</p></div><a class="docs-sourcelink" href="https://github.com/harmoniqs/QuantumCollocationCore.jl/blob/624a5f4c1c514a95ec303e1b377c923488705b30/src/losses/quantum_state_infidelity_loss.jl#L10-L14" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#QuantumCollocationCore.Losses.iso_infidelity" id="QuantumCollocationCore.Losses.iso_infidelity"><code>QuantumCollocationCore.Losses.iso_infidelity</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">iso_infidelity(ψ̃, ψ̃goal)</code></pre><p>Returns the iso_infidelity between two quantum statevectors specified in the <span>$\mathbb{C}^n \to \mathbb{R}^{2n}$</span> isomorphism space.</p></div><a class="docs-sourcelink" href="https://github.com/harmoniqs/QuantumCollocationCore.jl/blob/624a5f4c1c514a95ec303e1b377c923488705b30/src/losses/quantum_state_infidelity_loss.jl#L40-L46" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#QuantumCollocationCore.Losses.iso_vec_unitary_fidelity-Tuple{AbstractVector, AbstractVector}" id="QuantumCollocationCore.Losses.iso_vec_unitary_fidelity-Tuple{AbstractVector, AbstractVector}"><code>QuantumCollocationCore.Losses.iso_vec_unitary_fidelity</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">iso_vec_unitary_fidelity(Ũ⃗::AbstractVector, Ũ⃗_goal::AbstractVector)</code></pre><p>Returns the fidelity between the isomorphic unitary vector <span>$\vec{\widetilde{U}} \sim U \in SU(n)$</span> and the isomorphic goal unitary vector <span>$\vec{\widetilde{U}}_{\text{goal}}$</span>.</p><p class="math-container">\[\begin{aligned}
\mathcal{F}(\vec{\widetilde{U}}, \vec{\widetilde{U}}_{\text{goal}}) &amp;= \frac{1}{n} \abs{\tr \qty(U_{\text{goal}}^\dagger U)} \\
&amp;= \frac{1}{n} \sqrt{T_R^{2} + T_I^{2}}
\end{aligned}\]</p><p>where <span>$T_R = \langle \vec{\widetilde{U}}_{\text{goal}, R}, \vec{\widetilde{U}}_R \rangle + \langle \vec{\widetilde{U}}_{\text{goal}, I}, \vec{\widetilde{U}}_I \rangle$</span> and <span>$T_I = \langle \vec{\widetilde{U}}_{\text{goal}, R}, \vec{\widetilde{U}}_I \rangle - \langle \vec{\widetilde{U}}_{\text{goal}, I}, \vec{\widetilde{U}}_R \rangle$</span>.</p></div><a class="docs-sourcelink" href="https://github.com/harmoniqs/QuantumCollocationCore.jl/blob/624a5f4c1c514a95ec303e1b377c923488705b30/src/losses/unitary_infidelity_loss.jl#L41-L56" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#QuantumCollocationCore.Losses.unitary_fidelity-Tuple{AbstractMatrix, AbstractMatrix}" id="QuantumCollocationCore.Losses.unitary_fidelity-Tuple{AbstractMatrix, AbstractMatrix}"><code>QuantumCollocationCore.Losses.unitary_fidelity</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">unitary_fidelity(U::Matrix, U_goal::Matrix; kwargs...)
unitary_fidelity(Ũ⃗::AbstractVector, Ũ⃗_goal::AbstractVector; kwargs...)</code></pre><p>Calculate the fidelity between two unitary operators <code>U</code> and <code>U_goal</code>.</p><p class="math-container">\[\mathcal{F}(U, U_{\text{goal}}) = \frac{1}{n} \abs{\tr \qty(U_{\text{goal}}^\dagger U)}\]</p><p>where <span>$n$</span> is the dimension of the unitary operators.</p><p><strong>Keyword Arguments</strong></p><ul><li><code>subspace::AbstractVector{Int}</code>: The subspace to calculate the fidelity over.</li></ul></div><a class="docs-sourcelink" href="https://github.com/harmoniqs/QuantumCollocationCore.jl/blob/624a5f4c1c514a95ec303e1b377c923488705b30/src/losses/unitary_infidelity_loss.jl#L13-L27" target="_blank">source</a></section></article><h2 id="Objectives"><a class="docs-heading-anchor" href="#Objectives">Objectives</a><a id="Objectives-1"></a><a class="docs-heading-anchor-permalink" href="#Objectives" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#QuantumCollocationCore.Objectives.Objective" id="QuantumCollocationCore.Objectives.Objective"><code>QuantumCollocationCore.Objectives.Objective</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Objective</code></pre><p>A structure for defining objective functions.</p><p>The <code>terms</code> field contains all the arguments needed to construct the objective function.</p><p>Fields:     <code>L</code>: the objective function     <code>∇L</code>: the gradient of the objective function     <code>∂²L</code>: the Hessian of the objective function     <code>∂²L_structure</code>: the structure of the Hessian of the objective function     <code>terms</code>: a vector of dictionaries containing the terms of the objective function</p></div><a class="docs-sourcelink" href="https://github.com/harmoniqs/QuantumCollocationCore.jl/blob/624a5f4c1c514a95ec303e1b377c923488705b30/src/objectives/_objectives.jl#L41-L54" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#QuantumCollocationCore.Objectives.L1Regularizer-Tuple{}" id="QuantumCollocationCore.Objectives.L1Regularizer-Tuple{}"><code>QuantumCollocationCore.Objectives.L1Regularizer</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">L1Regularizer</code></pre><p>Create an L1 regularizer for the trajectory component. The regularizer is defined as</p><p class="math-container">\[J_{L1}(u) = \sum_t \abs{R \cdot u_t}\]</p><p>where (R) is the regularization matrix and (u_t) is the trajectory component at time (t).</p></div><a class="docs-sourcelink" href="https://github.com/harmoniqs/QuantumCollocationCore.jl/blob/624a5f4c1c514a95ec303e1b377c923488705b30/src/objectives/regularizer_objective.jl#L328-L340" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#QuantumCollocationCore.Objectives.MinimumTimeObjective-Tuple{}" id="QuantumCollocationCore.Objectives.MinimumTimeObjective-Tuple{}"><code>QuantumCollocationCore.Objectives.MinimumTimeObjective</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MinimumTimeObjective</code></pre><p>A type of objective that counts the time taken to complete a task.</p><p>Fields:     <code>D</code>: a scaling factor     <code>Δt_indices</code>: the indices of the time steps     <code>eval_hessian</code>: whether to evaluate the Hessian</p></div><a class="docs-sourcelink" href="https://github.com/harmoniqs/QuantumCollocationCore.jl/blob/624a5f4c1c514a95ec303e1b377c923488705b30/src/objectives/minimum_time_objective.jl#L4-L14" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#QuantumCollocationCore.Objectives.PairwiseQuadraticRegularizer-Tuple{AbstractVector{&lt;:Real}, AbstractVector{Int64}, Symbol, Symbol}" id="QuantumCollocationCore.Objectives.PairwiseQuadraticRegularizer-Tuple{AbstractVector{&lt;:Real}, AbstractVector{Int64}, Symbol, Symbol}"><code>QuantumCollocationCore.Objectives.PairwiseQuadraticRegularizer</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PairwiseQuadraticRegularizer</code></pre><p>Create a pairwise quadratic regularizer for the trajectory component <code>name</code> with regularization strength <code>R</code>. The regularizer is defined as</p><p class="math-container">\[    J_{v⃗}(u) = \sum_t \frac{1}{2} \Delta t_t^2 (v⃗_{1,t} - v⃗_{2,t})^T R (v⃗_{1,t} - v⃗_{2,t})\]</p><p>where <span>$v⃗_{1}$</span> and <span>$v⃗_{2}$</span> are selected by <code>name1</code> and <code>name2</code>. The indices specify the appropriate block diagonal components of the direct sum vector <code>v⃗</code>.</p><p>TODO: Hessian not implemented</p><p>Fields:     <code>R</code>: the regularization strength     <code>times</code>: the time steps to apply the regularizer     <code>name1</code>: the first name     <code>name2</code>: the second name     <code>timestep_name</code>: the symbol for the timestep     <code>eval_hessian</code>: whether to evaluate the Hessian</p></div><a class="docs-sourcelink" href="https://github.com/harmoniqs/QuantumCollocationCore.jl/blob/624a5f4c1c514a95ec303e1b377c923488705b30/src/objectives/regularizer_objective.jl#L426-L449" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#QuantumCollocationCore.Objectives.PairwiseQuadraticRegularizer-Tuple{NamedTrajectories.StructNamedTrajectory.NamedTrajectory, Union{Float64, AbstractVector{&lt;:Float64}}, AbstractVector{&lt;:Tuple{Symbol, Symbol}}}" id="QuantumCollocationCore.Objectives.PairwiseQuadraticRegularizer-Tuple{NamedTrajectories.StructNamedTrajectory.NamedTrajectory, Union{Float64, AbstractVector{&lt;:Float64}}, AbstractVector{&lt;:Tuple{Symbol, Symbol}}}"><code>QuantumCollocationCore.Objectives.PairwiseQuadraticRegularizer</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PairwiseQuadraticRegularizer</code></pre><p>A convenience constructor for creating a PairwiseQuadraticRegularizer for the trajectory component <code>name</code> with regularization strength <code>Rs</code> over the graph <code>graph</code>.</p></div><a class="docs-sourcelink" href="https://github.com/harmoniqs/QuantumCollocationCore.jl/blob/624a5f4c1c514a95ec303e1b377c923488705b30/src/objectives/regularizer_objective.jl#L515-L520" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#QuantumCollocationCore.Objectives.PairwiseUnitaryRobustnessObjective-Tuple{}" id="QuantumCollocationCore.Objectives.PairwiseUnitaryRobustnessObjective-Tuple{}"><code>QuantumCollocationCore.Objectives.PairwiseUnitaryRobustnessObjective</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PairwiseUnitaryRobustnessObjective(;
    H1::Union{AbstractPiccoloOperator, Nothing}=nothing,
    H2_error::Union{AbstractPiccoloOperator, Nothing}=nothing,
    symb1::Symbol=:Ũ⃗1,
    symb2::Symbol=:Ũ⃗2,
    eval_hessian::Bool=false,
)</code></pre><p>Create a control objective which penalizes the sensitivity of the infidelity to the provided operators defined in the subspaces of the control dynamics, thereby realizing robust control.</p></div><a class="docs-sourcelink" href="https://github.com/harmoniqs/QuantumCollocationCore.jl/blob/624a5f4c1c514a95ec303e1b377c923488705b30/src/objectives/unitary_robustness_objective.jl#L128-L139" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#QuantumCollocationCore.Objectives.QuadraticRegularizer-Tuple{}" id="QuantumCollocationCore.Objectives.QuadraticRegularizer-Tuple{}"><code>QuantumCollocationCore.Objectives.QuadraticRegularizer</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">QuadraticRegularizer</code></pre><p>A quadratic regularizer for a trajectory component.</p><p>Fields:     <code>name</code>: the name of the trajectory component to regularize     <code>times</code>: the times at which to evaluate the regularizer     <code>dim</code>: the dimension of the trajectory component     <code>R</code>: the regularization matrix     <code>baseline</code>: the baseline values for the trajectory component     <code>eval_hessian</code>: whether to evaluate the Hessian of the regularizer     <code>timestep_name</code>: the symbol for the timestep variable</p></div><a class="docs-sourcelink" href="https://github.com/harmoniqs/QuantumCollocationCore.jl/blob/624a5f4c1c514a95ec303e1b377c923488705b30/src/objectives/regularizer_objective.jl#L12-L25" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#QuantumCollocationCore.Objectives.QuadraticSmoothnessRegularizer-Tuple{}" id="QuantumCollocationCore.Objectives.QuadraticSmoothnessRegularizer-Tuple{}"><code>QuantumCollocationCore.Objectives.QuadraticSmoothnessRegularizer</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">QuadraticSmoothnessRegularizer</code></pre><p>A quadratic smoothness regularizer for a trajectory component.</p><p>Fields:     <code>name</code>: the name of the trajectory component to regularize     <code>times</code>: the times at which to evaluate the regularizer     <code>R</code>: the regularization matrix     <code>eval_hessian</code>: whether to evaluate the Hessian of the regularizer</p></div><a class="docs-sourcelink" href="https://github.com/harmoniqs/QuantumCollocationCore.jl/blob/624a5f4c1c514a95ec303e1b377c923488705b30/src/objectives/regularizer_objective.jl#L184-L194" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#QuantumCollocationCore.Objectives.QuantumObjective-Tuple{}" id="QuantumCollocationCore.Objectives.QuantumObjective-Tuple{}"><code>QuantumCollocationCore.Objectives.QuantumObjective</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">QuantumObjective

A generic objective function for quantum trajectories that use a loss.</code></pre></div><a class="docs-sourcelink" href="https://github.com/harmoniqs/QuantumCollocationCore.jl/blob/624a5f4c1c514a95ec303e1b377c923488705b30/src/objectives/quantum_objective.jl#L9-L14" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#QuantumCollocationCore.Objectives.UnitaryFreePhaseInfidelityObjective-Union{Tuple{}, Tuple{R}} where R&lt;:Real" id="QuantumCollocationCore.Objectives.UnitaryFreePhaseInfidelityObjective-Union{Tuple{}, Tuple{R}} where R&lt;:Real"><code>QuantumCollocationCore.Objectives.UnitaryFreePhaseInfidelityObjective</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">UnitaryFreePhaseInfidelityObjective</code></pre><p>A type of objective that measures the infidelity of a unitary operator to a target unitary operator, where the target unitary operator is allowed to have phases on qubit subspaces.</p><p>Fields:     <code>name</code>: the name of the unitary operator in the trajectory     <code>global_name</code>: the name of the global phase in the trajectory     <code>goal</code>: the target unitary operator     <code>Q</code>: a scaling factor     <code>eval_hessian</code>: whether to evaluate the Hessian     <code>subspace</code>: the subspace in which to evaluate the objective</p></div><a class="docs-sourcelink" href="https://github.com/harmoniqs/QuantumCollocationCore.jl/blob/624a5f4c1c514a95ec303e1b377c923488705b30/src/objectives/unitary_infidelity_objective.jl#L106-L120" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#QuantumCollocationCore.Objectives.UnitaryInfidelityObjective-Tuple{}" id="QuantumCollocationCore.Objectives.UnitaryInfidelityObjective-Tuple{}"><code>QuantumCollocationCore.Objectives.UnitaryInfidelityObjective</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">UnitaryInfidelityObjective</code></pre><p>A type of objective that measures the infidelity of a unitary operator to a target unitary operator.</p><p>Fields:     <code>name</code>: the name of the unitary operator in the trajectory     <code>goal</code>: the target unitary operator     <code>Q</code>: a scaling factor     <code>eval_hessian</code>: whether to evaluate the Hessian     <code>subspace</code>: the subspace in which to evaluate the objective</p></div><a class="docs-sourcelink" href="https://github.com/harmoniqs/QuantumCollocationCore.jl/blob/624a5f4c1c514a95ec303e1b377c923488705b30/src/objectives/unitary_infidelity_objective.jl#L8-L20" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#QuantumCollocationCore.Objectives.UnitaryRobustnessObjective-Tuple{}" id="QuantumCollocationCore.Objectives.UnitaryRobustnessObjective-Tuple{}"><code>QuantumCollocationCore.Objectives.UnitaryRobustnessObjective</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>UnitaryRobustnessObjective(;     H::::Union{AbstractPiccoloOperator, Nothing}=nothing,     eval_hessian::Bool=false,     symb::Symbol=:Ũ⃗ )</p><p>Create a control objective which penalizes the sensitivity of the infidelity to the provided operator defined in the subspace of the control dynamics, thereby realizing robust control.</p><p>The control dynamics are</p><p class="math-container">\[U_C(a)= \prod_t \exp{-i H_C(a_t)}\]</p><p>In the control frame, the H operator is (proportional to)</p><p class="math-container">\[R_{Robust}(a) = \frac{1}{T \norm{H_e}_2} \sum_t U_C(a_t)^\dag H_e U_C(a_t) \Delta t\]</p><p>where we have adjusted to a unitless expression of the operator.</p><p>The robustness objective is</p><p class="math-container">\[R_{Robust}(a) = \frac{1}{N} \norm{R}^2_F\]</p><p>where N is the dimension of the Hilbert space.</p></div><a class="docs-sourcelink" href="https://github.com/harmoniqs/QuantumCollocationCore.jl/blob/624a5f4c1c514a95ec303e1b377c923488705b30/src/objectives/unitary_robustness_objective.jl#L8-L34" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#QuantumCollocationCore.Objectives.sparse_to_moi-Tuple{SparseArrays.SparseMatrixCSC}" id="QuantumCollocationCore.Objectives.sparse_to_moi-Tuple{SparseArrays.SparseMatrixCSC}"><code>QuantumCollocationCore.Objectives.sparse_to_moi</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sparse_to_moi(A::SparseMatrixCSC)</code></pre><p>Converts a sparse matrix to tuple of vector of nonzero indices and vector of nonzero values</p></div><a class="docs-sourcelink" href="https://github.com/harmoniqs/QuantumCollocationCore.jl/blob/624a5f4c1c514a95ec303e1b377c923488705b30/src/objectives/_objectives.jl#L26-L30" target="_blank">source</a></section></article><h2 id="Dynamics"><a class="docs-heading-anchor" href="#Dynamics">Dynamics</a><a id="Dynamics-1"></a><a class="docs-heading-anchor-permalink" href="#Dynamics" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#QuantumCollocationCore.Dynamics.QuantumDynamics" id="QuantumCollocationCore.Dynamics.QuantumDynamics"><code>QuantumCollocationCore.Dynamics.QuantumDynamics</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">QuantumDynamics &lt;: AbstractDynamics</code></pre></div><a class="docs-sourcelink" href="https://github.com/harmoniqs/QuantumCollocationCore.jl/blob/624a5f4c1c514a95ec303e1b377c923488705b30/src/dynamics.jl#L22-L24" target="_blank">source</a></section></article><h2 id="Options"><a class="docs-heading-anchor" href="#Options">Options</a><a id="Options-1"></a><a class="docs-heading-anchor-permalink" href="#Options" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#QuantumCollocationCore.Options.IpoptOptions" id="QuantumCollocationCore.Options.IpoptOptions"><code>QuantumCollocationCore.Options.IpoptOptions</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Solver options for Ipopt

https://coin-or.github.io/Ipopt/OPTIONS.html#OPT_print_options_documentation</code></pre></div><a class="docs-sourcelink" href="https://github.com/harmoniqs/QuantumCollocationCore.jl/blob/624a5f4c1c514a95ec303e1b377c923488705b30/src/options.jl#L14-L18" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#QuantumCollocationCore.Options.PiccoloOptions" id="QuantumCollocationCore.Options.PiccoloOptions"><code>QuantumCollocationCore.Options.PiccoloOptions</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PiccoloOptions</code></pre><p>Options for the Piccolo quantum optimal control library.</p><p><strong>Fields</strong></p><ul><li><code>verbose::Bool = true</code>: Print verbose output</li><li><code>verbose_evaluator::Bool = false</code>: Print verbose output from the evaluator</li><li><code>free_time::Bool = true</code>: Allow free time optimization</li><li><code>timesteps_all_equal::Bool = true</code>: Use equal timesteps</li><li><code>integrator::Symbol = :pade</code>: Integrator to use</li><li><code>pade_order::Int = 4</code>: Order of the Pade approximation</li><li><code>rollout_integrator::Function = expv</code>: Integrator to use for rollout</li><li><code>eval_hessian::Bool = false</code>: Evaluate the Hessian</li><li><code>geodesic = true</code>: Use the geodesic to initialize the optimization.</li><li><code>blas_multithreading::Bool = true</code>: Use BLAS multithreading.</li><li><code>build_trajectory_constraints::Bool = true</code>: Build trajectory constraints.</li><li><code>complex_control_norm_constraint_name::Union{Nothing, Symbol} = nothing</code>: Name of the complex control norm constraint.</li><li><code>complex_control_norm_constraint_radius::Float64 = 1.0</code>: Radius of the complex control norm constraint.</li><li><code>bound_state::Bool = false</code>: Bound the state.</li><li><code>leakage_suppression::Bool = false</code>: Suppress leakage.</li><li><code>R_leakage::Float64 = 1.0</code>: Leakage suppression parameter.</li><li><code>free_phase_infidelity::Bool = false</code>: Free phase infidelity.</li><li><code>phase_operators::Union{Nothing, AbstractVector{&lt;:AbstractMatrix{&lt;:Complex}}} = nothing</code>: Phase operators.</li><li><code>phase_name::Symbol = :ϕ</code>: Name of the phase.</li></ul></div><a class="docs-sourcelink" href="https://github.com/harmoniqs/QuantumCollocationCore.jl/blob/624a5f4c1c514a95ec303e1b377c923488705b30/src/options.jl#L57-L82" target="_blank">source</a></section></article><h2 id="Problem-Solvers"><a class="docs-heading-anchor" href="#Problem-Solvers">Problem Solvers</a><a id="Problem-Solvers-1"></a><a class="docs-heading-anchor-permalink" href="#Problem-Solvers" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#QuantumCollocationCore.ProblemSolvers.solve!-Tuple{QuantumControlProblem}" id="QuantumCollocationCore.ProblemSolvers.solve!-Tuple{QuantumControlProblem}"><code>QuantumCollocationCore.ProblemSolvers.solve!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>solve!(prob::QuantumControlProblem;         init<em>traj=nothing,         save</em>path=nothing,         max<em>iter=prob.ipopt</em>options.max<em>iter,         linear</em>solver=prob.ipopt<em>options.linear</em>solver,         print<em>level=prob.ipopt</em>options.print<em>level,         remove</em>slack<em>variables=false,         callback=nothing         # state</em>type=:unitary,         # print_fidelity=false,     )</p><pre><code class="nohighlight hljs">Call optimization solver to solve the quantum control problem with parameters and callbacks.</code></pre><p><strong>Arguments</strong></p><ul><li><code>prob::QuantumControlProblem</code>: The quantum control problem to solve.</li><li><code>init_traj::NamedTrajectory</code>: Initial guess for the control trajectory. If not provided, a random guess will be generated.</li><li><code>save_path::String</code>: Path to save the problem after optimization.</li><li><code>max_iter::Int</code>: Maximum number of iterations for the optimization solver.</li><li><code>linear_solver::String</code>: Linear solver to use for the optimization solver (e.g., "mumps", "paradiso", etc).</li><li><code>print_level::Int</code>: Verbosity level for the solver.</li><li><code>remove_slack_variables::Bool</code>: Remove slack variables from the trajectory after optimization.</li><li><code>callback::Function</code>: Callback function to call during optimization steps.</li></ul></div><a class="docs-sourcelink" href="https://github.com/harmoniqs/QuantumCollocationCore.jl/blob/624a5f4c1c514a95ec303e1b377c923488705b30/src/problem_solvers.jl#L15-L39" target="_blank">source</a></section></article><h2 id="Problems"><a class="docs-heading-anchor" href="#Problems">Problems</a><a id="Problems-1"></a><a class="docs-heading-anchor-permalink" href="#Problems" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#QuantumCollocationCore.Problems.QuantumControlProblem" id="QuantumCollocationCore.Problems.QuantumControlProblem"><code>QuantumCollocationCore.Problems.QuantumControlProblem</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mutable struct QuantumControlProblem &lt;: AbstractProblem</code></pre><p>Stores all the information needed to set up and solve a QuantumControlProblem as well as the solution after the solver terminates.</p><p><strong>Fields</strong></p><ul><li><code>optimizer::Ipopt.Optimizer</code>: Ipopt optimizer object</li></ul></div><a class="docs-sourcelink" href="https://github.com/harmoniqs/QuantumCollocationCore.jl/blob/624a5f4c1c514a95ec303e1b377c923488705b30/src/problems.jl#L34-L42" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#QuantumCollocationCore.Problems.get_constraints-Tuple{QuantumControlProblem}" id="QuantumCollocationCore.Problems.get_constraints-Tuple{QuantumControlProblem}"><code>QuantumCollocationCore.Problems.get_constraints</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_constraints(prob::QuantumControlProblem)</code></pre><p>Return the constraints of the <code>prob::QuantumControlProblem</code>.</p></div><a class="docs-sourcelink" href="https://github.com/harmoniqs/QuantumCollocationCore.jl/blob/624a5f4c1c514a95ec303e1b377c923488705b30/src/problems.jl#L370-L374" target="_blank">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" href="#QuantumCollocationCore.Problems.get_objective-Tuple{QuantumControlProblem}" id="QuantumCollocationCore.Problems.get_objective-Tuple{QuantumControlProblem}"><code>QuantumCollocationCore.Problems.get_objective</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_objective(prob::QuantumControlProblem)</code></pre><p>Return the objective function of the <code>prob::QuantumControlProblem</code>.</p></div><a class="docs-sourcelink" href="https://github.com/harmoniqs/QuantumCollocationCore.jl/blob/624a5f4c1c514a95ec303e1b377c923488705b30/src/problems.jl#L348-L352" target="_blank">source</a></section></article><h2 id="Saving-and-Loading"><a class="docs-heading-anchor" href="#Saving-and-Loading">Saving and Loading</a><a id="Saving-and-Loading-1"></a><a class="docs-heading-anchor-permalink" href="#Saving-and-Loading" title="Permalink"></a></h2></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../generated/explanation/">Explanation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label></p><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div><p></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Friday 28 February 2025 08:33">Friday 28 February 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div><div data-docstringscollapsed="true"></div></body></HTML>